# JS Engine Exposed, Google V8 Architecture

## What is a JavaScript Engine?

A JavaScript Engine is a program that:

- Reads JavaScript code (source code)
- Parses and compiles it
- Executes it on the machine

**Different environments have different engines:**

- Chrome / Node.js â†’ V8
- Firefox â†’ SpiderMonkey
- Safari â†’ JavaScriptCore

ğŸ’¡ **"JS Engine exposed" usually means:**

- Understanding how the JS engine works internally (execution flow, memory handling, optimizations)
- Knowing which parts are exposed to developers (e.g., ECMAScript features)
- Recognizing what's not part of the JS engine (e.g., DOM APIs, setTimeout â€” these come from the environment, not the engine itself)

## Google V8 â€” Overview

**V8 is:**

- Open-source JavaScript & WebAssembly engine
- Written in C++
- Used in:
  - Google Chrome
  - Node.js
  - Deno

**Known for:**

- JIT compilation (Just-In-Time)
- Garbage Collection (automatic memory management)
- High performance

## V8 Architecture â€” Main Components

Here's the big picture:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ JavaScript Source Code  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
      1ï¸âƒ£ Parser
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Abstract Syntax Tree    â”‚
â”‚ (AST)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
2ï¸âƒ£ Interpreter (Ignition)
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bytecode                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    Hot Code Detected
            â”‚
3ï¸âƒ£ Optimizing Compiler (TurboFan)
            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Optimized Machine Code  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Step-by-step in detail:

### 1. Parser

- Takes JS source code and creates an AST (Abstract Syntax Tree).
- The AST is a structured representation of code, making it easier for the engine to analyze.

### 2. Ignition (Interpreter)

- Converts AST â†’ Bytecode (lightweight instructions for the engine to execute).
- Runs the code immediately without waiting for full compilation.
- This gives fast startup.

### 3. TurboFan (Optimizing Compiler)

- Watches code while it runs.
- If it sees a function running many times (a "hot" function), it optimizes it into highly efficient machine code.
- Makes repeated operations faster.

## Memory Management in V8

**Heap** â†’ Stores objects, arrays, closures, etc.

**Stack** â†’ Stores function calls and primitive variables

**Garbage Collector (Orinoco / Oilpan):**

- Automatically frees memory for objects that are no longer reachable
- Uses generational GC (young vs old objects)
- Uses incremental & concurrent GC to avoid blocking execution

## V8 and the JS Runtime

**Important: V8 only runs JavaScript.**

It doesn't:

- Provide DOM APIs (document.querySelector, etc.)
- Provide setTimeout, fetch

Those come from the host environment:

- Browser â†’ Web APIs
- Node.js â†’ libuv & Node APIs

**The runtime = V8 + host environment APIs + Event Loop.**

## Interview-ready Short Answer

"V8 is Google's high-performance open-source JavaScript and WebAssembly engine, written in C++. It parses JS into an AST, interprets it into bytecode with Ignition, and optimizes hot code into machine code with TurboFan. It also manages memory with an advanced garbage collector. V8 doesn't provide DOM or timers â€” those come from the host environment like browsers or Node.js, which, together with V8 and the Event Loop, form the full JavaScript runtime."

## Visual Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    JavaScript Code      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Parser          â”‚ â†’ AST
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ignition Interpreter   â”‚ â†’ Bytecode
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
    Hot Functions Detected
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   TurboFan Compiler     â”‚ â†’ Optimized Machine Code
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
