# Promise APIs + Interview Questions

## Core Promise Concepts

**Definition:**
A Promise is an object representing the eventual completion (or failure) of an asynchronous operation.
It has three states:

- **Pending** → initial state
- **Fulfilled** → resolved successfully
- **Rejected** → failed with an error

**Why Promises exist:**

- Avoid callback hell
- Make async code more readable
- Provide error handling with `.catch()`

**Basic syntax:**

```js
const myPromise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('Data fetched');
    // reject("Error occurred");
  }, 1000);
});

myPromise
  .then((data) => console.log(data))
  .catch((err) => console.error(err))
  .finally(() => console.log('Done'));
```

## Promise APIs

### Creating a Promise

```js
new Promise((resolve, reject) => { ... })
```

### Promise.resolve(value)

Returns a fulfilled promise with the given value.

```js
Promise.resolve(42).then(console.log); // 42
```

### Promise.reject(reason)

Returns a rejected promise.

```js
Promise.reject('Error').catch(console.error);
```

### Promise.all(iterable)

- Takes an array (or iterable) of promises.
- Resolves only if all promises succeed.
- Rejects immediately if any fail.

```js
Promise.all([Promise.resolve(1), Promise.resolve(2)]).then(console.log); // [1, 2]
```

**Use case:** Fetch multiple APIs in parallel when all results are needed.

### Promise.allSettled(iterable)

- Waits for all promises to settle (fulfilled or rejected).
- Returns an array with `{status, value/reason}`.

```js
Promise.allSettled([Promise.resolve(1), Promise.reject('Error')]).then(
  console.log
);
```

**Use case:** Need results of all promises regardless of success/failure.

### Promise.race(iterable)

Resolves/rejects as soon as the first promise settles.

```js
Promise.race([
  new Promise((res) => setTimeout(() => res('Fast'), 100)),
  new Promise((res) => setTimeout(() => res('Slow'), 500)),
]).then(console.log); // "Fast"
```

**Use case:** Timeouts or fastest API wins.

### Promise.any(iterable) (ES2021+)

- Resolves when first fulfilled promise is found.
- Ignores rejections until all fail.
- Rejects with AggregateError if all fail.

```js
Promise.any([Promise.reject('Fail'), Promise.resolve('Win')]).then(console.log); // "Win"
```

**Use case:** Use first available successful result.

### Chaining

```js
fetchData()
  .then(processData)
  .then(saveData)
  .catch(handleError)
  .finally(() => console.log('Cleanup'));
```

## Interview Questions

### Basic

1. What are the states of a Promise?
2. Difference between `.then()` and `.catch()`?
3. How do you create a resolved or rejected Promise instantly?
4. Why are Promises better than callbacks?

### Intermediate

1. Difference between `Promise.all()` and `Promise.allSettled()`?
2. When would you use `Promise.race()`?
3. Difference between `Promise.any()` and `Promise.race()`?
4. What happens if you don't handle a rejected Promise?

### Advanced / Tricky

1. **Explain microtask queue in relation to Promises.**
   (Promises' `.then()` callbacks run in the microtask queue after the current call stack, before the next macrotask.)

2. **What happens if you return a Promise inside `.then()`?**
   (It will chain and wait for that Promise to settle.)

3. **Can you cancel a Promise?**
   (Not directly; need AbortController or custom logic.)

4. **How would you implement a timeout wrapper using `Promise.race()`?**

```js
function timeout(promise, ms) {
  const timer = new Promise((_, reject) =>
    setTimeout(() => reject('Timeout'), ms)
  );
  return Promise.race([promise, timer]);
}
```
